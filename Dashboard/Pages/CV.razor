@page "/cv"

@using Microsoft.JSInterop
@using Microsoft.AspNetCore.Components.Web
@using global::Dashboard.Models

@inject IJSRuntime JS
@rendermode RenderMode.InteractiveServer

<style>
    .technos span { display:inline-block; margin:5px; padding:5px 10px; font-size:.9rem; }

    .techno-csharp{ background-color:#823eb7; color:white; }
    .techno-javascript{ background-color:#f7df1e; color:black; }
    .techno-angular{ background-color:#F70746; color:white; }
    .techno-dotnet{ background-color:#512bd4; color:white; }
    .techno-sql-server{ background-color:#cc2927; color:white; }
    .techno-azure-devops{ background-color:#0078d7; color:white; }
    .techno-cicd{ background-color:#4caf50; color:white; }
    .techno-php{ background-color:#777bb4; color:white; }
    .techno-mysql{ background-color:#f29111; color:black; }
    .techno-python{ background-color:#3572a5; color:white; }
    .techno-vba{ background-color:#217346; color:white; }
    .techno-gitlab{ background-color:#f29111; color:black; }
    .techno-asp{ background-color:#0078d7; color:white; }

    .techno-default { background-color: rgba(255,255,255,.12); color:white; }
</style>

<div class="container">
    @{
        var index = 0;
    }

    @foreach (var exp in Experiences)
    {
        <div class="card afficher mb-3 p-4" data-index="@index">

            <div class="d-flex flex-column flex-md-row gap-2 mt-2">
                <div class="bb-box-orange-fill flex-grow-1 d-flex align-items-center">
                    <h2 class="m-0">@exp.Titre</h2>
                </div>

                <div class="bb-box-red flex-grow-1 d-flex align-items-center justify-content-end">
                    <h2 class="m-0">@exp.Entreprise</h2>
                </div>
            </div>


            <span class="bb-text-orange">Période : @exp.Periode</span>

            <!-- Equivalent de Html.Raw -->
            <div>@((MarkupString)exp.Description)</div>

            <div class="technos">
                @foreach (var techno in exp.Technos)
                {
                    <span class="@GetTechClass(techno)">@techno</span>
                }
            </div>
        </div>

        index++;
    }
</div>

@code {

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
            await JS.InvokeVoidAsync("cvFadeInit");
    }

    // Mets ici ta liste (copie-colle depuis ton HomeController.CV() si elle est en dur)
    private static readonly List<Experience> Experiences = new()
    {
         new Experience
                {
                    Titre = "Développeur .NET",
                    LogoEntreprise = string.Empty,
                    Entreprise = "Adentis / Crédit Agricole",
                    Periode = "Mars 2024 - Maintenant",
                    Description = "<p>J'ai travaillé comme développeur .NET pour le Crédit Agricole dans le cadre d'une refonte d'un grand nombre d'applications à réécrire en C# .NET 8.0</p>",
                    Technos = new List<string>{ "C#", ".NET Core", "ASP.NET", "GitLab", "CI/CD", "SQL Server" }
                },
                new Experience
                {
                    Titre = "Développeur .NET",
                    LogoEntreprise = string.Empty,
                    Entreprise = "Alten / Doxallia Groupe Crédit Agricole",
                    Periode = "Octobre 2024 - Février 2024",
                    Description = "<p>J'ai travaillé comme développeur .NET à la Direction des Systèmes d'Information pour Doxallia, filiale du Crédit Agricole, principalement sur une API C# .NET 8.0 avec une importante partie DevOps.</p><p>Pour la mise en production de l'API j'ai installé et configuré les serveurs IIS et créé la pipeline CI/CD Azure Devops Server. J'ai aussi participé à la sécurisation du SI, notamment dans le développement et la gestion des flux entre les serveurs de la plateforme sur laquelle je travaillais. Mon travail consistait aussi à maintenir les serveurs applicatifs et serveurs de bases de données de ma plateforme</p>",
                    Technos = new List<string>{ "C#", ".NET Core", "Azure DevOps", "CI/CD", "SQL Server" }
                },
                new Experience
                {
                    Titre = "Développeur .NET",
                    LogoEntreprise = string.Empty,
                    Entreprise = "BPCE-IT",
                    Periode = "Septembre 2022 - Aout 2024",
                    Description = "<p>J'ai travaillé en alternance chez BPCE-IT sur la refonte d’un logiciel pour le helpdesk, de .NET Framework 4.8 vers .NET Core 6.0 et la création d'une nouvelle architecture.</p><p>Le helpdesk BPCE-IT utilise ce logiciel pour effectuer des diagnostics, modifier les parametres de la machine distante, ouvrir un ticket avec des informations préremplies ou prendre la main à distance, et a besoin d'un logiciel à la fois fiable et rapide.</p><p>La codebase était ancienne avec beaucoup de code legacy, le logiciel était en .NET Framework 4.8 et était très buggé. J'ai développé la nouvelle version en .NET Core 6.0. J'ai aussi développé une API RESTful pour s'interfacer avec les bases de données suite à la fermeture des flux, liée à la sécurisation du SI.</p>",
                    Technos = new List<string>{ "C#", ".NET Core", "SQL Server" }
                },
                new Experience
                {
                    Titre = "Master Développement Logiciel",
                    LogoEntreprise = string.Empty,
                    Entreprise = "IPI Groupe IGS",
                    Periode = "Septembre 2022 - Aout 2024",
                    Description = string.Empty,
                    Technos = new List<string>{ "C#", ".NET Core", "Python", "Angular", "CI/CD", "SQL Server" }
                },
                new Experience
                {
                    Titre = "Développeur Fullstack",
                    LogoEntreprise = string.Empty,
                    Entreprise = "CREA2F",
                    Periode = "Juin 2021 - Décembre 2021",
                    Description = "<p>J'ai travaillé en CDD chez CREA2F, une agence de communication spécialisée dans les solutions web, en tant que développeur Fullstack Javascript PHP pour créer des sites vitrines et des CMS.</p><p>J'ai eu l'opportunité de travailler sur plusieurs projets pour différents clients. Je gérais à la fois le développement frontend et backend, mais aussi la mise en production. J'ai travaillé avec du Javascript et du PHP.</p><p>Cette expérience a confirmé mon choix de devenir développeur et j'ai finalement décidé de développer mes compétences avec un Master Ingénieur Logiciel.</p>",
                    Technos = new List<string>{ "Angular", "PHP", "MySQL" }
                },
                new Experience
                {
                    Titre = "Bac +3 Développement Backend",
                    LogoEntreprise = string.Empty,
                    Entreprise = "Openclassrooms",
                    Periode = "Janvier 2020 - Aout 2022",
                    Description = string.Empty,
                    Technos = new List<string>{ "PHP", "MySQL", "JavaScript" }
                },
                new Experience
                {
                    Titre = "Analyste Restrictions d'Investissement",
                    LogoEntreprise = string.Empty,
                    Entreprise = "Caceis Luxembourg",
                    Periode = "Janvier 2019 - Décembre 2020",
                    Description = "<p>J'ai travaillé en tant qu'analyste en restrictions d'investissement chez CACEIS, une filiale du Crédit Agricole spécialisée dans les services aux investisseurs.</p><p>Mon rôle d'analyste en restrictions d'investissement consistait à monitorer des portefeuilles financiers grâce à un logiciel spécialisé. Quand des données étaient manquantes il fallait exporter les résultats sur Excel et refaire les calculs avec les nouvelles données. J'ai créé des macros VBA et des scripts Python pour automatiser ces calculs pour gagner du temps mais aussi de la fiabilité.</p><p>Ces automatisations m'ont permis de gagner du temps, ce qui m'a permis de passer plus de temps à programmer, et j'ai finalement décidé d'en faire un travail à temps plein et de devenir développeur.</p>",
                    Technos = new List<string>{ "Python", "VBA" }
                },
                new Experience
                {
                    Titre = "Master Finance de marché - Trading",
                    LogoEntreprise = string.Empty,
                    Entreprise = "ESG Finance Paris",
                    Periode = "Septembre 2016 - Aout 2018",
                    Description = string.Empty,
                    Technos = new List<string>{ "Python", "VBA" }
                }
    };

    private static string GetTechClass(string techno)
    {
        if (string.IsNullOrWhiteSpace(techno)) return "techno-default";
        var key = techno.Trim().ToLowerInvariant();

        return key switch
        {
            "c#" => "techno-csharp",
            "javascript" => "techno-javascript",
            "angular" => "techno-angular",
            ".net core" => "techno-dotnet",
            "sql server" => "techno-sql-server",
            "azure devops" => "techno-azure-devops",
            "ci/cd" => "techno-cicd",
            "php" => "techno-php",
            "mysql" => "techno-mysql",
            "python" => "techno-python",
            "vba" => "techno-vba",
            "gitlab" => "techno-gitlab",
            "asp.net" => "techno-asp",
            _ => "techno-default"
        };
    }
}
